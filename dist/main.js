(()=>{"use strict";let e={success:!1,unit:"metric",data:null};function t(){return e.data}let n={};function s(){return(()=>{const e=t();n={cityName:e.resolvedAddress,date:e.days[0].datetime,dateTime:e.currentConditions.datetime,temp:e.currentConditions.temp,condition:e.currentConditions.conditions,icon:e.currentConditions.icon,humidity:e.currentConditions.humidity,windSpeed:e.currentConditions.windspeed,highTemp:e.days[0].tempmax,sunrise:e.currentConditions.sunrise,sunset:e.currentConditions.sunset}})(),n}let c=[];function i(){return(()=>{const e=t(),n=e.days[0].hours.concat(e.days[1].hours),s=(new Date).getHours(),i=n.slice(s,s+24);c=i.map((e=>({time:e.datetime.slice(0,5),icon:e.icon,temperature:e.temp})))})(),c}let o,a=[];function r(){return(()=>{const e=t().days.slice(0,7);a=e.map(((e,t)=>{const n=new Date(e.datetime);return{day:0===t?"Today":n.toLocaleDateString("en-Us",{weekday:"long"}),icon:e.icon,temperature:e.temp}}))})(),a}function d(e,t){const{sunrise:n,sunset:c}=s();let i;i=t?e.getTime():function(e){const[t,n]=e.split(":").map(Number),s=new Date,c=parseInt(n)<30?t:t+1;return s.setHours(c),s}(e).getTime();const[o,a,r]=n.split(":"),d=new Date;d.setHours(o),d.setMinutes(a);const m=d.setSeconds(r),[l,u,y]=c.split(":"),g=new Date;g.setHours(l),g.setMinutes(u);const p=g.setSeconds(y);return i>=m&&i<p?"day":"night"}const m=(e,t)=>{let n;switch(e){case"snow":case"rain":case"fog":case"wind":case"cloudy":n=`${e}-${t}`;break;case"snow-showers-day":n="snow-day";break;case"snow-showers-night":n="snow-night";break;case"thunder-rain":n=`storm-${t}`;break;case"thunder-showers-day":n="storm-day";break;case"thunder-showers-night":n="storm-night";break;case"showers-day":case"showers-night":case"partly-cloudy-day":case"partly-cloudy-night":case"clear-day":case"clear-night":n=e}return`icons/${n}.svg`},l=document.getElementById("loadingIcon"),u=document.getElementById("loading"),y=["clear-day","clear-night","partly-cloudy-day","partly-cloudy-night","cloudy-day","cloudy-night","rain-day","rain-night"];let g=0;const p=()=>{g=(g+1)%y.length,l.src=`icons/${y[g]}.svg`};function h(){u.classList.remove("active")}const f=document.getElementById("content"),w=document.getElementById("error"),E=e=>{const t=s(),n=d(t.dateTime,!0);!function(e){const t=document.documentElement;"night"===e?(t.style.setProperty("--BG-COLOR-1","linear-gradient(to bottom right,#003366,#001f3f)"),t.style.setProperty("--BG-COLOR-2","#0F2836"),t.style.setProperty("--BG-COLOR-3","linear-gradient(to top left,#272746,#37374d)"),t.style.setProperty("--ACTION-COLOR","linear-gradient(to top right,#280044,#3f016c)"),t.style.setProperty("--TEXT-COLOR","#fff")):(t.style.setProperty("--BG-COLOR-1","linear-gradient(to bottom right,#00c6ff,#0072ff)"),t.style.setProperty("--BG-COLOR-2","#d8f4fc"),t.style.setProperty("--BG-COLOR-3","linear-gradient(to top left,#e9e9e9,#ffffff)"),t.style.setProperty("--ACTION-COLOR","linear-gradient(to top right,#ffaa00,#ffd700)"),t.style.setProperty("--TEXT-COLOR","#000"))}(n),function(e,t){(e=>{document.getElementById("date").innerText=e})(t),o&&clearInterval(o);const n=new Date(e);o=setInterval((()=>{(e=>{const t=document.getElementById("clock");e.setSeconds(e.getSeconds()+1);const n=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");t.innerText=`${n}:${s}:${c}`})(n)}),1e3)}(t.dateTime,t.date),document.getElementById("cityName").innerText=t.cityName,document.getElementById("currentWeatherIcon").src=m(t.icon,n),document.getElementById("temperature").innerHTML=`<h2>${t.temp}&deg;</h2><span>${t.condition}</span>`,document.getElementById("humidityInfo").innerText=`${t.humidity}%`,document.getElementById("windSpeed").innerText=`${t.windSpeed} ${"metric"===e?"Kph":"Mph"}`,document.getElementById("highTemp").innerHTML=`${t.highTemp}&deg;`;const c=document.getElementById("sunriseTime"),i=t.sunrise.slice(0,5);c.innerText=i;const a=document.getElementById("sunsetTime"),r=t.sunset.slice(0,5);a.innerText=r},T=()=>{const e=i(),t=document.getElementById("hourlyForecast");e.map(((e,n)=>{const s=document.createElement("li"),c=document.createElement("span");c.className="time",c.innerText=0===n?"Now":e.time,s.appendChild(c);const i=d(e.time,!1),o=document.createElement("img");o.className="icon",o.src=m(e.icon,i),s.appendChild(o);const a=document.createElement("span");a.className="degree",a.innerHTML=`${e.temperature}&deg;`,s.appendChild(a),t.appendChild(s)}))},C=()=>{const e=r(),t=document.getElementById("weeklyForecast");e.map((e=>{const n=document.createElement("li"),s=document.createElement("span");s.className="day",s.innerText=e.day,n.appendChild(s);const c=document.createElement("img");c.className="icon",c.src=m(e.icon,"day"),n.appendChild(c);const i=document.createElement("span");i.className="degree",i.innerHTML=`${e.temperature}&deg;`,n.appendChild(i),t.appendChild(n)}))};function I(){f.classList.remove("active")}function v(){w.classList.remove("active")}const B=async(n,s)=>{!function(t){e.unit=t}(s),I(),v(),u.classList.add("active"),setInterval(p,2e3),await async function(t,n){const s=`https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/${encodeURIComponent(t)}?unitGroup=${n}&include=current,hours,day&iconSet=icons2&key=GQ9CS732CEKG55K85Y6JJ248D&contentType=json`;try{const t=await fetch(s);if(!t.ok){const n=await t.text();return e.success=!1,void(e.data=n.split(":").pop())}const n=await t.json();e.success=!0,e.data=n,e.data.currentConditions.datetime=await(async e=>{const t=`https://timeapi.io/api/Time/current/zone?timeZone=${e}`,n=await fetch(t),s=await n.json();return new Date(s.dateTime)})(n.timezone)}catch(t){e.success=!1,e.data=t.message}}(n,s),e.success?(v(),h(),f.classList.add("active"),(()=>{const t=e.unit;E(t),T(),C()})()):(I(),h(),w.classList.add("active"),(()=>{const e=t();document.getElementById("errorMessage").innerText=e})())},L=document.getElementById("toggleUnit"),O=document.getElementById("toggleText"),$=document.getElementById("refreshBtn"),S=document.getElementById("cityForm"),k=document.getElementById("cityInput");L.addEventListener("click",(()=>{"metric"===L.value?(L.value="us",O.innerHTML="&deg;F"):(L.value="metric",O.innerHTML="&deg;C"),L.classList.toggle("active")})),$.addEventListener("click",(()=>{window.location.reload()})),S.addEventListener("submit",(e=>{e.preventDefault();const t=k.value.trim(),n=L.value;B(t,n)}))})();